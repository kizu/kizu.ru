<style>
.example4-1 {
  height: 12rem;
  container-type: size;
}

.example4 .context {
  width: min-content;
  position: relative;
  z-index: 0;
  min-height: 0;
}

.example4-1 .resizer {
  position: relative;
  overflow: hidden;
  resize: both;
  
  width: 5em;
  height: 5em;
  max-width: 100cqw;
  max-height: 100cqh;
  border: 1px solid hotpink;
}

.example4 .background {
  position: absolute;
  z-index: -1;
  inset: 0;
  container-type: size;
  pointer-events: none;
}

/* Not a pseudo-element due to a Safari bug */
.example4 .background-content {
  position: absolute;
  inset: 0;
  width: calc(100cqw + var(--fix, 0px));
  height: 100cqh;
  transition: 0.5s 0.15s;
  transition-property: width, height;
  background: pink;

  /* Need this to work around two Firefox bugs */
  animation: firefox-size-fix 0.001s;
}

@keyframes firefox-size-fix {
  from {
    --fix: 0.0001px;
  }
  to {
    width: 100%;
    height: 100%;
  }
}
</style>
<div class="example4 example4-1">
  <div class="context">
    <div class="background"><div class="background-content"></div></div>
    <div class="resizer"></div>
  </div>
</div>

