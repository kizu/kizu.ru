# Браузеры против таблиц

#Practical #Bugs #HTML

Сложные таблицы являются, наверное, одним из самых интересных мест в верстке.

В последнее время мне нужно верстать очень много таблиц, при этом разных и со всякими дополнительными элементами. И требованиями.

В этой статье я расскажу про несколько моментов, с которыми я встретился за последние пару месяцев.

## Выделение таблиц и `TFOOT`

По спецификации блок `TFOOT` должен идти до блока `TBODY`, при этом в самой таблице он выводится последним. С первого взгляда всё нормально, но если вдруг нам надо будет выделить содержимое таблицы мы столкнемся с тем, что в отображении `TFOOT` ставится в конец только визуально и выделяя текст в таблице выделение будет вести себя соответственно: выделяя всю таблицу с верхнего левого угла по нижний правый мы выделим всю таблицу за исключением `TBODY` (В Opera, однако, алгоритм слегка иной, и можно таким образом выделить всю таблицу, но и своих глюков с этим в ней хватает).

Попробуйте сами по-всякому выделять текст в таблице:

<table border="1">
    <thead>
        <tr>
            <th>THEAD-TH</th>
            <td>THEAD-TD</td>
        </tr>
    </thead>
    <tfoot>
        <tr>
            <th>TFOOT-TH</th>
            <td>TFOOT-TD</td>
        </tr>
    </tfoot>
    <tbody>
        <tr>
            <th>TBODY-TH</th>
            <td>TBODY-TD</td>
        </tr>
    </tbody>
</table>

Конечно, можно выделить всю таблицу — начиная с THEAD-TH и заканчивая TBODY-TD, но простые пользователи будут озадачены когда столкнутся с таким поведением выделения.

## Копирование таблицы в буфер обмена

Подобное поведение `TFOOT` также влияет и на то, что уйдет в буфер обмена, если таблицу выделить и вставить в текстовый редактор или, скажем, Excel.

В большинстве браузеров `TFOOT` будет идти до `TBODY`. В Opera, если умудриться выделить всю таблицу, `TBODY` всё будет нормально. Но это если выделить — скажем, при выполнении команды «Выделить всё» `TFOOT` по неизвестным причинам не выделяется. А вручную приходится заниматься пиксель-хантингом.

В проекте, который я сейчас верстаю, таблицы в том или ином виде присутствуют почти на всех страницах, и требования по выделению и копированию появляются не просто так. И из-за недопонимания браузерами рендеринга таблиц в этом проекте пришлось отказаться от семантики `TFOOT`.

## Не существующие аттрибуты `CHAR` и `CHAROFF`

Если внимательно почитать спецификации, можно найти очень много интересных и полезных вещей. Однако, кое-где можно встретить приписки вроде _User agents are not required to support this attribute_, например в [описании](https://www.w3.org/TR/html401/struct/tables.html#adef-charoff) поведения горизонтального выравнивания яячеек в присутствии аттрибута `CHAROFF`

По спецификации, связка из аттрибутов `ALIGN`, `CHAR` и/или `CHAROFF` может очень помочь для правильно визуального представления информации. Однако, насколько мне известно, ни один из хоть сколько-нибудь популярных браузеров не реализовал эту возможность.

Приведу [пример из спецификации](https://www.w3.org/TR/html401/struct/tables.html#adef-charoff) (по ссылке можно увидеть как предполагается рендерить подобное свойство):

<table border="1">
    <colgroup>
        <col />
        <col align="char" char="." />
    </colgroup>
    <thead>
        <tr>
            <th>Vegetable</th>
            <th>Cost per kilo</th>
        </tr>
        </thead>
    <tbody>
        <tr>
            <td>Lettuce</td>
            <td>$1</td>
        </tr>
        <tr>
            <td>Silver carrots</td>
            <td>$10.50</td>
        </tr>
        <tr>
            <td>Golden turnips</td>
            <td>$100.30</td>
        </tr>
    </tbody>
</table>

Такая функциональность мне сейчас в проекте очень приходилась бы, но увы, производители браузеров решили забыть про неё.

## Нулевые `COLSPAN` и `ROWSPAN`

Еще одна полезная вещь, присутствующая в спецификации — возможность задать ячейке `COLSPAN` или `ROWSPAN` равные нулю.

[В спецификации](https://www.w3.org/TR/html401/struct/tables.html#adef-rowspan) HTML явно написано, что при нулевом значении этих аттрибутов ячейка должна растягиваться на всю строку или столбец. Однако, правильно рендерит ячейки с таким свойством лишь Firefox, а Опера понимает лишь нулевой `ROWSPAN`.

Пример:

<table border="1">
    <tbody align="center">
        <tr>
            <td rowspan="4">TD rowspan=4</td>
            <td colspan="4">TD colspan=4</td>
            <td rowspan="0">TD rowspan=0</td>
        </tr>
        <tr>
            <th>simple TH</th>
            <td>simple TD</td>
            <td>simple TD</td>
            <td>simple TD</td>
        </tr>
        <tr>
            <td colspan="0">TD colspan=0</td>
        </tr>
        <tr>
            <th>simple TH</th>
            <td>simple TD</td>
            <td>simple TD</td>
            <td>simple TD</td>
        </tr>
    </tbody>
</table>

Таким образом, ещё одну полезную функциональность, описанную в спецификации, нельзя применять из-за неполной поддержки браузерами.

