<!DOCTYPE html>
<html lang="en" class="Page Page_post Page_en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Conditions for CSS Variables</title>
    <link rel="alternate" type="application/atom+xml" title="Atom feed" href="http://feeds.feedburner.com/kizuruen">
    <link rel="alternate" hreflang="en" href="http://kizu.ru/en/fun/conditions-for-css-variables/">
    <link rel="alternate" hreflang="ru" href="http://kizu.ru/fun/conditions-for-css-variables/">
    <link rel="stylesheet" href="/s/style.css">
    <link rel="preload" href="/s/extras2.css" as="style" onload="this.rel='stylesheet'">
  </head>
  <body class="Page-Body">
    <header class="Page-Header">
      <div class="LiquidLayout">
        <div class="LiquidLayout-Content">
          <h1 class="Page-Title"><a href="/en/" class="Page-Title-Link">RomanÂ Komarov</a>
          </h1>
          <ul class="Page-Languages">
            <li data-short="en" class="Page-Language is-current">in English
            </li>
            <li class="Page-Language"><a data-short="ru" href="/fun/conditions-for-css-variables/" class="Page-Language-Link">Ğ¿Ğ¾-Ñ€ÑƒÑÑĞºĞ¸</a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <article role="main" class="Page-Content">
      <div class="LiquidLayout">
        <div class="Main LiquidLayout-Content">
          <header><h1 class="Heading" id="conditions-for-css-variables"><a class="Anchor" aria-hidden="true" href="#conditions-for-css-variables"></a><span class="ss02 hang-xs">C</span>onÂ­diÂ­tions forÂ <abbr>CSS</abbr> VariÂ­ables</h1>
          </header>
<p>I&#39;ll start from this: <span class="Sidenote-Wrapper"><a class="Sidenote-Context" href="#not-those" id="not-those">there are no</a><span class="Sidenote" role="note"><span class="Sidenote-Misc"> (</span>There isÂ aÂ modÂ­ule named â€œ<a href="https://www.w3.org/TR/css3-conditional/"><abbr>CSS</abbr> ConÂ­diÂ­tional Rules</a>â€, but don&#39;t exÂ­pect itÂ toÂ cover theÂ <abbr>CSS</abbr> variÂ­<span class="nobr">ablesâ€‰â€”</span><span class="thinsp">â€‰</span>itÂ covÂ­ers some <span class="nobr">at-rules</span> stuff. There isÂ even aÂ <a href="https://tabatkins.github.io/specs/css-when-else/">proÂ­posal</a> forÂ <code>@when</code>/<code>@else</code> <span class="nobr">at-rules</span>, which, again, doÂ not anyÂ­thing inÂ comÂ­mon with variÂ­ables.<span class="Sidenote-Misc">)</span></span><a class="Sidenote-Close" href="#x" aria-hidden="true" tabindex="-1"></a></span> conÂ­diÂ­tions inÂ specs toÂ use with <a class="Link" href="https://www.w3.org/TR/css-variables-1/"><abbr>CSS</abbr> variÂ­ables</a>. IÂ think that this isÂ aÂ reÂ­ally big flaw inÂ specs, asÂ while variÂ­ables alÂ­ready proÂ­vide aÂ lot ofÂ things that were not posÂ­siÂ­ble inÂ any other way beÂ­fore, theÂ abÂ­sence ofÂ conÂ­diÂ­tions isÂ reÂ­ally frusÂ­tratÂ­ing, asÂ there could beÂ aÂ lot ofÂ uses forÂ them.</p>
<p>But what ifÂ we&#39;d need those imagÂ­iÂ­nary conÂ­diÂ­tional stateÂ­ments forÂ our <abbr>CSS</abbr> variÂ­ables <em>now</em>? Well, asÂ with aÂ lot ofÂ other <abbr>CSS</abbr> stuff, weÂ can hack our way around forÂ same cases.</p>
<h2 class="Heading" id="the-problem-39-s-definition"><a class="Anchor" aria-hidden="true" href="#the-problem-39-s-definition"></a><span class="ss01 hang-m">T</span>heÂ ProbÂ­lem&#39;s DeÂ­fÂ­iÂ­nÂ­ition</h2>
<p>So, what weÂ need isÂ aÂ way toÂ use aÂ sinÂ­gle <abbr>CSS</abbr> variÂ­able forÂ setÂ­ting difÂ­ferÂ­ent <abbr>CSS</abbr> propÂ­erÂ­ties toÂ <em>difÂ­ferÂ­ent</em> valÂ­ues, but not based diÂ­rectly onÂ this variÂ­able (that <span class="nobr">isâ€‰â€”</span><span class="thinsp">â€‰</span>those valÂ­ues shouldn&#39;t beÂ <em>calÂ­cuÂ­lated</em> from our variÂ­able). WeÂ need <strong>conÂ­diÂ­tions</strong>.</p>
<h2 class="Heading" id="using-calculations-for-binary-conditions"><a class="Anchor" aria-hidden="true" href="#using-calculations-for-binary-conditions"></a><span class="ss01 hang-m">U</span>sing CalÂ­cuÂ­laÂ­tions forÂ BiÂ­nary ConÂ­ditions</h2>
<p>Long story short, I&#39;ll just preÂ­sent theÂ soÂ­luÂ­tion toÂ you right now andÂ would exÂ­plain itÂ later:</p>
<pre><code class="language-css">:root {
    --is-big: 0;
}

.is-big {
    --is-big: 1;
}

.block {
    padding: calc(
        25px * var(--is-big) +
        10px * (1 - var(--is-big))
    );
    border-width: calc(
        3px * var(--is-big) +
        1px * (1 - var(--is-big))
    );
}
</code></pre>
<p>InÂ this exÂ­amÂ­ple, we&#39;re makÂ­ing all our elÂ­eÂ­ments with <code>.block</code> toÂ have paddings equal toÂ <code>10px</code> andÂ borÂ­der widths toÂ <code>1px</code> unÂ­less theÂ <code>--is-big</code> variÂ­able onÂ those elÂ­eÂ­ments won&#39;t beÂ <code>1</code>, inÂ which case they would beÂ­come <code>25px</code> andÂ <code>3px</code> reÂ­specÂ­tively.</p>
<p>TheÂ mechÂ­aÂ­nism beÂ­yond this isÂ rather simÂ­ple: weÂ use both our posÂ­siÂ­ble valÂ­ues inÂ aÂ sinÂ­gle calÂ­cuÂ­laÂ­tion usÂ­ing <code>calc()</code>, where weÂ nulÂ­lify one andÂ keep anÂ­other value based onÂ theÂ variÂ­able&#39;s value which can beÂ eiÂ­ther <code>1</code> orÂ <code>0</code>. InÂ other words, we&#39;ll have <code>25px * 1 + 10px * 0</code> inÂ one case andÂ <code>25px * 0 + 10px * 1</code> inÂ anÂ­other.</p>
<h2 class="Heading" id="more-complex-conditions"><a class="Anchor" aria-hidden="true" href="#more-complex-conditions"></a><span class="ss01 hang-m">M</span>ore ComÂ­plex ConÂ­ditions</h2>
<p>WeÂ can use this method toÂ choose not only from 2 posÂ­siÂ­ble valÂ­ues but forÂ choosÂ­ing from 3 orÂ more valÂ­ues. HowÂ­ever, forÂ each new added posÂ­siÂ­ble value theÂ calÂ­cuÂ­laÂ­tion beÂ­comes more comÂ­plex. ForÂ choosÂ­ing beÂ­tween 3 posÂ­siÂ­ble valÂ­ues itÂ would alÂ­ready look like this:</p>
<pre><code class="language-css">.block {
    padding: calc(
        100px * (1 - var(--foo)) * (2 - var(--foo)) * 0.5 +
         20px * var(--foo) * (2 - var(--foo)) +
          3px * var(--foo) * (1 - var(--foo)) * -0.5
    );
}
</code></pre>
<p>This could acÂ­cept <code>0</code>, <code>1</code> andÂ <code>2</code> valÂ­ues forÂ <code>--foo</code> variÂ­able andÂ calÂ­cuÂ­late theÂ padding toÂ <code>100px</code>, <code>20px</code> orÂ <code>3px</code> corÂ­reÂ­spondÂ­ingly.</p>
<p>TheÂ prinÂ­ciÂ­ple isÂ theÂ same: weÂ just need toÂ mulÂ­tiÂ­ply each posÂ­siÂ­ble value toÂ anÂ exÂ­presÂ­sion that would beÂ equal toÂ <code>1</code> when theÂ conÂ­diÂ­tion forÂ this value isÂ theÂ one weÂ need andÂ toÂ <code>0</code> inÂ other cases. AndÂ this exÂ­presÂ­sion can beÂ comÂ­posed rather easÂ­ily: weÂ just need toÂ nulÂ­lify each other posÂ­siÂ­ble value ofÂ our conÂ­diÂ­tional variÂ­able. AfÂ­ter doÂ­ing this we&#39;d need toÂ add our trigÂ­gerÂ­ing value there toÂ see ifÂ we&#39;d need toÂ adÂ­just theÂ reÂ­sult soÂ itÂ would beÂ equal toÂ 1. AndÂ that&#39;s it.</p>
<h3 class="Heading" id="a-possible-trap-in-the-specs"><a class="Anchor" aria-hidden="true" href="#a-possible-trap-in-the-specs"></a><span class="ss01 hang-xs">A</span> PosÂ­siÂ­ble Trap inÂ theÂ Specs</h3>
<p>With theÂ inÂ­creasÂ­ing comÂ­plexÂ­ity ofÂ such calÂ­cuÂ­laÂ­tions, there isÂ aÂ chance atÂ one point they would stop from workÂ­ing. Why? There isÂ this note inÂ <a class="Link" href="https://drafts.csswg.org/css-values-3/#calc-syntax">specs</a>:</p>
<blockquote>
<p>UAs must supÂ­port calc() exÂ­presÂ­sions ofÂ atÂ least 20 terms, where each <abbr>NUM</abbr>Â­<abbr>BER</abbr>, DIÂ­<abbr>MEN</abbr>Â­<abbr>SION</abbr>, orÂ <abbr>PER</abbr>Â­<abbr>CENT</abbr>Â­<abbr>AGE</abbr> isÂ aÂ term. IfÂ aÂ calc() exÂ­presÂ­sion conÂ­tains more than theÂ supÂ­ported numÂ­ber ofÂ terms, itÂ must beÂ treated asÂ ifÂ itÂ were inÂ­valid.</p>
</blockquote>
<p>OfÂ course, IÂ tested this aÂ bit andÂ couldn&#39;t found such limÂ­iÂ­taÂ­tions inÂ theÂ browsers IÂ tested, but there isÂ still aÂ chance eiÂ­ther you would write some reÂ­ally comÂ­plex code that would meet theÂ posÂ­siÂ­ble exÂ­istÂ­ing limit, orÂ some ofÂ theÂ browsers could inÂ­troÂ­duce this limit inÂ theÂ fuÂ­ture, soÂ beÂ careÂ­ful when usÂ­ing reÂ­ally comÂ­plex calÂ­cuÂ­laÂ­tions.</p>
<h2 class="Heading" id="conditions-for-colors"><a class="Anchor" aria-hidden="true" href="#conditions-for-colors"></a><span class="ss02 hang-xs">C</span>onÂ­diÂ­tions forÂ Colors</h2>
<p>AsÂ you can see, those calÂ­cuÂ­laÂ­tions could beÂ used only forÂ things that you can <em>calÂ­cuÂ­late</em>, soÂ there isÂ noÂ chance weÂ could use itÂ forÂ switchÂ­ing theÂ valÂ­ues ofÂ <code>disÂ­play</code> propÂ­erty orÂ any other <span class="nobr">non-nu</span>Â­meric ones. But what about colÂ­ors? AcÂ­tuÂ­ally, weÂ can calÂ­cuÂ­late theÂ inÂ­diÂ­vidÂ­ual comÂ­poÂ­nents ofÂ theÂ colÂ­ors. Sadly, right now itÂ would work only inÂ WeÂ­bkits andÂ Blinks, asÂ <a class="Link" href="https://bugzilla.mozilla.org/show_bug.cgi?id=984021" title="Bugzilla ticket">FireÂ­fox don&#39;t yet supÂ­port</a> <code>calc()</code> inÂ­side <code>rgba()</code> andÂ other color funcÂ­tions.</p>
<p>But when theÂ supÂ­port would beÂ there (orÂ ifÂ you&#39;d like toÂ exÂ­perÂ­iÂ­ment onÂ this inÂ browsers with anÂ exÂ­istÂ­ing supÂ­port), weÂ could doÂ things like that:</p>
<pre><code class="language-css">:root {
    --is-red: 0;
}

.block {
    background: rgba(
        calc(
            255*var(--is-red) +
            0*(1 - var(--is-red))
            ),
        calc(
            0*var(--is-red) +
            255*(1 - var(--is-red))
            ),
        0, 1);
}
</code></pre>
<p>Here we&#39;d have lime color byÂ deÂ­fault andÂ red ifÂ theÂ <code>--is-red</code> would beÂ set toÂ <code>1</code> (note that when theÂ comÂ­poÂ­nent could beÂ zero weÂ could just omit itÂ atÂ all, makÂ­ing out code more comÂ­pact, here IÂ kept those forÂ clarÂ­ity ofÂ anÂ alÂ­goÂ­rithm).</p>
<p>AsÂ you could doÂ those calÂ­cuÂ­laÂ­tions with any comÂ­poÂ­nents, itÂ isÂ posÂ­siÂ­ble toÂ creÂ­ate those conÂ­diÂ­tions forÂ any colÂ­ors (andÂ maybe even forÂ graÂ­diÂ­ents? You should try it!).</p>
<h3 class="Heading" id="another-trap-in-the-specs"><a class="Anchor" aria-hidden="true" href="#another-trap-in-the-specs"></a><span class="ss01 hang-xs">A</span>nother Trap inÂ theÂ Specs</h3>
<p>When IÂ was testÂ­ing how theÂ conÂ­diÂ­tions work forÂ colÂ­ors, IÂ found out aÂ reÂ­ally, <em>reÂ­ally</em> <span class="Sidenote-Wrapper"><a class="Sidenote-Context" href="#issue-resolved" id="issue-resolved">weird limÂ­iÂ­taÂ­tion inÂ Specs</a><span class="Sidenote" role="note"><span class="Sidenote-Misc"> (</span>Tab Atkins <a href="https://github.com/kizu/kizu.github.com/issues/186">comÂ­mented</a> that this isÂ­sue with color comÂ­poÂ­nents was fixed inÂ theÂ specs (but isÂ not yet supÂ­ported byÂ browsers). Yay! Also heÂ said that asÂ anÂ­other soÂ­luÂ­tion weÂ could just use perÂ­centÂ­ages inÂ­side <code>rgba</code>, IÂ toÂ­tally forÂ­got about this feaÂ­ture, haha.<span class="Sidenote-Misc">)</span></span><a class="Sidenote-Close" href="#x" aria-hidden="true" tabindex="-1"></a></span>. ItÂ isÂ called <a class="Link Link_wrapper" href="https://twitter.com/kizmarh/status/788504161864261632">â€œ<span class="Link-Inner">Type CheckÂ­ing</span>â€</a>. IÂ now ofÂ­fiÂ­cially hate it. What this means isÂ that ifÂ theÂ propÂ­erty acÂ­cepts only <code>&lt;inÂ­teÂ­ger&gt;</code> asÂ aÂ value, ifÂ you&#39;d have any diÂ­viÂ­sions orÂ <span class="nobr">non-in</span>Â­teÂ­gers inÂ­side theÂ <code>calc()</code> forÂ it, even ifÂ theÂ reÂ­sult would beÂ inÂ­teÂ­ger, theÂ â€œreÂ­solved typeâ€ wouldn&#39;t beÂ <code>&lt;inÂ­teÂ­ger&gt;</code>, itÂ would beÂ <code>&lt;numÂ­ber&gt;</code>, andÂ that means that those propÂ­erÂ­ties won&#39;t acÂ­cept such valÂ­ues. AndÂ when we&#39;d have calÂ­cuÂ­laÂ­tions inÂ­volvÂ­ing more than two posÂ­siÂ­ble valÂ­ues, we&#39;d need toÂ have aÂ <span class="nobr">non-in</span>Â­teÂ­ger modÂ­iÂ­fiers. AndÂ that would make our calÂ­cuÂ­laÂ­tion inÂ­valid forÂ usÂ­ing with colÂ­ors orÂ other inÂ­teÂ­ger-only propÂ­erÂ­ties (like <code>z-inÂ­dex</code>).</p>
<p>That is:</p>
<pre><code class="language-css">calc(255 * (1 - var(--bar)) * (var(--bar) - 2) * -0.5)
</code></pre>
<p>Would beÂ inÂ­valid when inÂ­side ofÂ theÂ <code>rgba()</code>. IniÂ­tially IÂ thought that this beÂ­havÂ­iour isÂ aÂ bug, esÂ­peÂ­cially knowÂ­ing how theÂ color funcÂ­tions can acÂ­tuÂ­ally acÂ­cept theÂ valÂ­ues that goÂ beÂ­yond theÂ posÂ­siÂ­ble ranges (you can doÂ <code>rgba(9001, +9001, -9001, 42)</code> andÂ get aÂ valid yelÂ­low color), but this typÂ­ing thing seems toÂ beÂ too hard forÂ browsers toÂ handle.</p>
<h4 class="Heading" id="solutions-"><a class="Anchor" aria-hidden="true" href="#solutions-"></a><span class="ss01 hang-xs">S</span>oluÂ­tions?</h4>
<p>There isÂ one far from perÂ­fect soÂ­luÂ­tion. AsÂ inÂ our case weÂ know both theÂ deÂ­sired value andÂ the probÂ­lemÂ­atic modÂ­iÂ­fier, weÂ can pre-calÂ­cuÂ­late them andÂ then round itÂ up. Yep, that means that theÂ reÂ­sultÂ­ing value could beÂ not exÂ­actly theÂ same, asÂ weÂ would lose some preÂ­ciÂ­sion inÂ some cases. But itÂ isÂ betÂ­ter than nothÂ­ing, right?</p>
<p>But there isÂ anÂ­other soÂ­luÂ­tion that would work forÂ colÂ­<span class="nobr">orsâ€‰â€”</span><span class="thinsp">â€‰</span>weÂ can use <code>hsla</code> inÂ­stead ofÂ <code>rgba</code>, asÂ itÂ acÂ­cepts not inÂ­teÂ­gers, but numÂ­bers andÂ perÂ­centÂ­ages, soÂ there won&#39;t beÂ aÂ conÂ­flict inÂ type reÂ­solvÂ­ing. But forÂ other propÂ­erÂ­ties like <code>z-inÂ­dex</code> that soÂ­luÂ­tion won&#39;t work. But even with this method there still could beÂ some losses inÂ preÂ­ciÂ­sion ifÂ you&#39;re goÂ­ing toÂ conÂ­vert <code>rgb</code> toÂ <code>hsl</code>. But those should beÂ less than inÂ preÂ­viÂ­ous soÂ­lution.</p>
<h2 class="Heading" id="preprocessing"><a class="Anchor" aria-hidden="true" href="#preprocessing"></a><span class="ss01 hang-m">P</span>reÂ­proÂ­cessing</h2>
<p>When theÂ conÂ­diÂ­tions are biÂ­nary itÂ isÂ still posÂ­siÂ­ble toÂ write them byÂ hand. But when we&#39;re startÂ­ing toÂ use more comÂ­plex conÂ­diÂ­tions, orÂ when we&#39;re getÂ­ting toÂ theÂ colÂ­ors, we&#39;d betÂ­ter have tools that could make itÂ easÂ­ier toÂ write. LuckÂ­ily, weÂ have preÂ­procesÂ­sors forÂ this purpose.</p>
<p>Here isÂ how IÂ manÂ­aged toÂ quickly doÂ itÂ inÂ <span class="Sidenote-Wrapper"><a class="Sidenote-Context" href="#pen" id="pen">StyÂ­lus</a><span class="Sidenote" role="note"><span class="Sidenote-Misc"> (</span>You can look atÂ <a href="http://codepen.io/kizu/pen/zKmyvG">CodeÂ­Pen with this code</a> inÂ acÂ­tion.<span class="Sidenote-Misc">)</span></span><a class="Sidenote-Close" href="#x" aria-hidden="true" tabindex="-1"></a></span>:</p>
<pre><code class="language-styl">conditional($var, $values...)
  $result = &#39;&#39;

  // If there is only an array passed, use its contents
  if length($values) == 1
    $values = $values[0]

  // Validating the values and check if we need to do anything at all
  $type = null
  $equal = true

  for $value, $i in $values
    if $i &gt; 0 and $value != $values[0]
      $equal = false

    $value_type = typeof($value)
    $type = $type || $value_type
    if !($type == &#39;unit&#39; or $type == &#39;rgba&#39;)
      error(&#39;Conditional function can accept only numbers or colors&#39;)

    if $type != $value_type
      error(&#39;Conditional function can accept only same type values&#39;)

  // If all the values are equal, just return one of them
  if $equal
    return $values[0]

  // Handling numbers
  if $type == &#39;unit&#39;
    $result = &#39;calc(&#39;
    $i_count = 0
    for $value, $i in $values
      $multiplier = &#39;&#39;
      $modifier = 1
      $j_count = 0
      for $j in 0..(length($values) - 1)
        if $j != $i
          $j_count = $j_count + 1
          // We could use just the general multiplier,
          // but for 0 and 1 we can simplify it a bit.
          if $j == 0
            $modifier = $modifier * $i
            $multiplier = $multiplier + $var
          else if $j == 1
            $modifier = $modifier * ($j - $i)
            $multiplier = $multiplier + &#39;(1 - &#39; + $var + &#39;)&#39;
          else
            $modifier = $modifier * ($i - $j)
            $multiplier = $multiplier + &#39;(&#39; + $var + &#39; - &#39; + $j + &#39;)&#39;

          if $j_count &lt; length($values) - 1
            $multiplier = $multiplier + &#39; * &#39;

      // If value is zero, just don&#39;t add it there lol
      if $value != 0
        if $modifier != 1
          $multiplier = $multiplier + &#39; * &#39; + (1 / $modifier)
        $result = $result + ($i_count &gt; 0 ? &#39; + &#39; : &#39;&#39;) + $value + &#39; * &#39; + $multiplier
        $i_count = $i_count + 1

    $result = $result + &#39;)&#39;

  // Handling colors
  if $type == &#39;rgba&#39;
    $hues = ()
    $saturations = ()
    $lightnesses = ()
    $alphas = ()

    for $value in $values
      push($hues, unit(hue($value), &#39;&#39;))
      push($saturations, saturation($value))
      push($lightnesses, lightness($value))
      push($alphas, alpha($value))

    $result = &#39;hsla(&#39; + conditional($var, $hues) + &#39;, &#39; + conditional($var, $saturations) + &#39;, &#39; + conditional($var, $lightnesses) + &#39;, &#39; + conditional($var, $alphas) +  &#39;)&#39;

  return unquote($result)
</code></pre>
<p>Yep, there isÂ aÂ lot ofÂ code, but this mixin can genÂ­erÂ­ate conÂ­diÂ­tionÂ­als both forÂ numÂ­bers andÂ colÂ­ors, andÂ not only forÂ two posÂ­siÂ­ble conÂ­diÂ­tions but forÂ many more.</p>
<p>TheÂ usÂ­age isÂ reÂ­ally easy:</p>
<pre><code class="language-styl">border-width: conditional(var(--foo), 10px, 20px)
</code></pre>
<p>TheÂ first arÂ­guÂ­ment isÂ our variÂ­able, theÂ secÂ­ond one isÂ theÂ value that should beÂ apÂ­plied when theÂ variÂ­able would beÂ equal toÂ <code>0</code>, theÂ <span class="nobr">thirdâ€‰â€”</span><span class="thinsp">â€‰</span>when itÂ would beÂ equal toÂ <code>1</code>, etc.</p>
<p>This above call would genÂ­erÂ­ate proper conÂ­diÂ­tional:</p>
<pre><code class="language-css">border-width: calc(10px * (1 - var(--foo)) + 20px * var(--foo));
</code></pre>
<p>AndÂ here isÂ aÂ more comÂ­plex exÂ­amÂ­ple forÂ the color conÂ­diÂ­tionals:</p>
<pre><code class="language-styl">color: conditional(var(--bar), red, lime, rebeccapurple, orange)
</code></pre>
<p>Would genÂ­erÂ­ate someÂ­thing that you surely wouldn&#39;t want toÂ write byÂ hand:</p>
<pre><code class="language-css">color: hsla(calc(120 * var(--bar) * (var(--bar) - 2) * (var(--bar) - 3) * 0.5 + 270 * var(--bar) * (1 - var(--bar)) * (var(--bar) - 3) * 0.5 + 38.82352941176471 * var(--bar) * (1 - var(--bar)) * (var(--bar) - 2) * -0.16666666666666666), calc(100% * (1 - var(--bar)) * (var(--bar) - 2) * (var(--bar) - 3) * 0.16666666666666666 + 100% * var(--bar) * (var(--bar) - 2) * (var(--bar) - 3) * 0.5 + 49.99999999999999% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 3) * 0.5 + 100% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 2) * -0.16666666666666666), calc(50% * (1 - var(--bar)) * (var(--bar) - 2) * (var(--bar) - 3) * 0.16666666666666666 + 50% * var(--bar) * (var(--bar) - 2) * (var(--bar) - 3) * 0.5 + 40% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 3) * 0.5 + 50% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 2) * -0.16666666666666666), 1);
</code></pre>
<p>Note that there isÂ noÂ deÂ­tecÂ­tion ofÂ <code>&lt;inÂ­teÂ­ger&gt;</code>-acÂ­ceptÂ­ing propÂ­erÂ­ties, soÂ that won&#39;t work forÂ <code>z-inÂ­dex</code> andÂ such, but itÂ alÂ­ready conÂ­verts colÂ­ors toÂ <code>hsla()</code> toÂ make them manÂ­ageÂ­ble (though even this could beÂ enÂ­hanced soÂ this conÂ­verÂ­taÂ­tion would hapÂ­pen only when itÂ would beÂ needed). AnÂ­other thing IÂ didn&#39;t imÂ­pleÂ­ment inÂ this mixin (yet?) isÂ theÂ abilÂ­ity toÂ use <abbr>CSS</abbr> variÂ­ables forÂ the valÂ­ues. This would beÂ posÂ­siÂ­ble forÂ <span class="nobr">non-in</span>Â­teÂ­ger numÂ­bers asÂ those valÂ­ues would beÂ inÂ­serted asÂ isÂ inÂ theÂ conÂ­diÂ­tional calÂ­cuÂ­laÂ­tions. Maybe, when I&#39;ll find time, I&#39;ll fix theÂ mixin toÂ acÂ­cept not only numÂ­bers orÂ colÂ­ors but also variÂ­ables. ForÂ the time beÂ­ing itÂ isÂ still posÂ­siÂ­ble toÂ doÂ usÂ­ing theÂ alÂ­goÂ­rithm exÂ­plained inÂ this arÂ­ticle.</p>
<h2 class="Heading" id="fallbacks"><a class="Anchor" aria-hidden="true" href="#fallbacks"></a><span class="ss01 hang-m">F</span>allbacks</h2>
<p>OfÂ course, ifÂ you&#39;re planÂ­ning toÂ acÂ­tuÂ­ally use this, you&#39;ll need toÂ have aÂ way toÂ set fallÂ­backs. They&#39;re easy forÂ browsers that just don&#39;t supÂ­port variÂ­ables: you just deÂ­clare theÂ fallÂ­back value beÂ­fore theÂ conÂ­diÂ­tional deÂ­cÂ­laÂ­ration:</p>
<pre><code class="language-css">.block {
    padding: 100px; /* fallback */
    padding: calc(
        100px * ((1 - var(--foo)) * (2 - var(--foo)) / 2) +
         20px * (var(--foo) * (2 - var(--foo))) +
          3px * (var(--foo) * (1 - var(--foo)) / -2)
    );
}
</code></pre>
<p>But when itÂ comes toÂ colÂ­ors weÂ have aÂ probÂ­lem: when there isÂ aÂ supÂ­port forÂ variÂ­ables, inÂ fact (andÂ that&#39;s anÂ­other reÂ­ally weird place inÂ specs), <em>just any</em> deÂ­cÂ­laÂ­raÂ­tion conÂ­tainÂ­ing variÂ­ables would beÂ conÂ­sidÂ­ered valid. AndÂ this means that itÂ isÂ not posÂ­siÂ­ble inÂ <abbr>CSS</abbr> toÂ make aÂ fallÂ­back forÂ someÂ­thing conÂ­tainÂ­ing variÂ­ables:</p>
<pre><code class="language-css">background: blue;
background: I ğŸ’© CSS VAR(--I)ABLES;
</code></pre>
<p>IsÂ valid <abbr>CSS</abbr> andÂ per specs, theÂ backÂ­ground would get anÂ <code>iniÂ­tial</code> value, not theÂ one proÂ­vided inÂ aÂ fallÂ­back (even though itÂ isÂ obÂ­viÂ­ous that theÂ other parts ofÂ theÂ value are inÂ­corÂ­rect).</p>
<p>So, what weÂ need inÂ orÂ­der toÂ proÂ­vide aÂ fallÂ­back inÂ those <span class="nobr">casesâ€‰â€”</span><span class="thinsp">â€‰</span>add <code>@supÂ­port</code> wrapÂ­per that would test theÂ supÂ­port forÂ everyÂ­thing <strong>exÂ­cept</strong> forÂ the variÂ­ables.</p>
<p>InÂ our case, weÂ need toÂ wrap our conÂ­diÂ­tional colÂ­ors forÂ FireÂ­fox inÂ someÂ­thing like this:</p>
<pre><code class="language-css">.block {
    color: #f00;
}
@supports (color: rgb(0, calc(0), 0)) {
    .block {
        color: rgba(calc(255 * (1 - var(--foo))), calc(255 * var(--foo)), 0, 1);
  }
}
</code></pre>
<p>Here we&#39;re testÂ­ing aÂ supÂ­port forÂ calÂ­cuÂ­laÂ­tions inÂ­side color funcÂ­tions andÂ apÂ­plyÂ­ing theÂ conÂ­diÂ­tional color only inÂ that case.</p>
<p>ItÂ isÂ also posÂ­siÂ­ble toÂ creÂ­ate such fallÂ­backs auÂ­toÂ­matÂ­iÂ­cally, but IÂ won&#39;t recÂ­omÂ­mend you toÂ use preÂ­procesÂ­sors forÂ them asÂ theÂ comÂ­plexÂ­ity ofÂ creÂ­atÂ­ing such stuff isÂ much more than theÂ caÂ­paÂ­bilÂ­iÂ­ties preÂ­procesÂ­sors provide.</p>
<h2 class="Heading" id="use-cases"><a class="Anchor" aria-hidden="true" href="#use-cases"></a><span class="ss01 hang-m">U</span>seÂ Cases</h2>
<p>IÂ reÂ­ally don&#39;t like toÂ proÂ­vide use cases forÂ the things theÂ need forÂ which isÂ obÂ­viÂ­ous. SoÂ I&#39;ll beÂ brief. AndÂ I&#39;ll state not only theÂ conÂ­diÂ­tions forÂ variÂ­ables, but also theÂ genÂ­eral conÂ­diÂ­tions, like forÂ the reÂ­sult ofÂ <code>calc()</code>.</p>
<ul>
<li><p>TheÂ conÂ­diÂ­tions forÂ <abbr>CSS</abbr> variÂ­ables would beÂ perÂ­fect forÂ themiÂ­fyÂ­ing blocks. This way you could have aÂ numÂ­ber ofÂ numÂ­bered themes andÂ then apÂ­ply them toÂ blocks (andÂ nested ones!) usÂ­ing just one <abbr>CSS</abbr> variÂ­able like <code>--block-variÂ­ant: 1</code>. This isÂ not someÂ­thing that isÂ posÂ­siÂ­ble through any other means other than variÂ­ables andÂ when you&#39;d want toÂ have difÂ­ferÂ­ent valÂ­ues forÂ difÂ­ferÂ­ent props inÂ difÂ­ferÂ­ent themes, withÂ­out theÂ conÂ­diÂ­tionÂ­als you&#39;d need toÂ have many difÂ­ferÂ­ent variÂ­ables andÂ apÂ­ply all ofÂ them inÂ every case.</p>
</li>
<li><p>TyÂ­pogÂ­raÂ­phy. IfÂ itÂ was posÂ­siÂ­ble toÂ use theÂ <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code> andÂ <code>&gt;=</code> inÂ conÂ­diÂ­tions forÂ variÂ­ables, itÂ would beÂ posÂ­siÂ­ble toÂ have aÂ numÂ­ber ofÂ â€œrulesâ€ forÂ difÂ­ferÂ­ent font sizes, soÂ you could set difÂ­ferÂ­ent line heights, font weights andÂ other propÂ­erÂ­ties based onÂ theÂ given font-size. This isÂ posÂ­siÂ­ble now, but now when you need toÂ have some â€œstopsâ€ forÂ those valÂ­uea andÂ not just theÂ valÂ­ues deÂ­rived from <code>em</code>s.</p>
</li>
<li><p>ReÂ­sponÂ­sive deÂ­sign. Well, ifÂ there were theÂ conÂ­diÂ­tions forÂ calÂ­cuÂ­laÂ­tions, then itÂ would beÂ alÂ­most theÂ same asÂ those eluÂ­sive â€œelÂ­eÂ­ment queriesâ€<span class="nobr">â€‰â€”</span><span class="thinsp">â€‰</span>you could check theÂ <code>vw</code> orÂ theÂ parÂ­ent&#39;s widths inÂ perÂ­cents andÂ deÂ­cide what toÂ apÂ­ply inÂ difÂ­ferÂ­ent cases.</p>
</li>
</ul>
<p>There can beÂ other use cases, tell meÂ ifÂ you&#39;d find one! I&#39;m sure IÂ had more ofÂ them myÂ­self, but IÂ don&#39;t have that good ofÂ aÂ memÂ­ory toÂ reÂ­memÂ­ber all theÂ things IÂ ever wanted toÂ doÂ with <abbr>CSS</abbr>. BeÂ­cause its all theÂ things.</p>
<h2 class="Heading" id="future"><a class="Anchor" aria-hidden="true" href="#future"></a><span class="ss01 hang-m">F</span>uture</h2>
<p>IÂ would reÂ­ally like toÂ see conÂ­diÂ­tions deÂ­scribed inÂ <abbr>CSS</abbr> specs, soÂ weÂ would not rely onÂ calc hacks andÂ could use proper conÂ­diÂ­tions forÂ non-calÂ­cuÂ­latÂ­able valÂ­ues too. ItÂ isÂ also imÂ­posÂ­siÂ­ble right now toÂ have conÂ­diÂ­tions other than strict equalÂ­ity, soÂ noÂ â€œwhen theÂ variÂ­able isÂ more than Xâ€ andÂ other stuff like that. IÂ don&#39;t see any reaÂ­sons why weÂ can&#39;t have proper conÂ­diÂ­tions inÂ <abbr>CSS</abbr>, soÂ ifÂ you know aÂ felÂ­low spec deÂ­velÂ­oper, hint them about this isÂ­sue. MyÂ only hope isÂ that they won&#39;t tell usÂ toÂ â€œjust use JSâ€ orÂ find out exÂ­cuses ofÂ why that wouldn&#39;t ever beÂ posÂ­siÂ­ble. Here, itÂ isÂ alÂ­ready posÂ­siÂ­ble now usÂ­ing theÂ hacks, there can&#39;t beÂ any exÂ­cuses.</p>

          <p class="Metadata Published">Published on 
            <time datetime="2016-10-21">October 21, 2016</time>, in <a href="../" class="Link">Experiments</a>.
          </p>
          <aside class="Feedback">
            <p>IfÂ you've spotted aÂ typo orÂ aÂ mistake, orÂ wish toÂ add somethingÂ on, you could either <a href="https://github.com/kizu/kizu.github.com/issues/new?title=Feedback%20for%20%E2%80%9CConditions%20for%20CSS%20Variables%E2%80%9D" class="Link">writeÂ meÂ aboutÂ this</a> or <a href="https://github.com/kizu/kizu.github.com/blob/source/src/documents/posts/2016-10-21-(fun)-conditions-for-css-variables/index.en.md" class="Link">edit this article on Github</a>.
            </p>
          </aside>
        </div>
      </div>
    </article>
    <footer class="Page-Footer">
      <div class="LiquidLayout">
        <div class="LiquidLayout-Content">
          <nav class="PrevNext"><a href="/en/blog/styling-inline-code/" class="Link Link_wrapper Link_prev"><span class="Link-Inner">Styling inline code</span></a><a href="/en/fun/controlling-the-specificity/" class="Link Link_wrapper Link_next"><span class="Link-Inner">Controlling the Specificity</span></a>
          </nav>
          <p role="contentinfo" class="Page-Copy"><a href="/en/" class="Link Link_wrapper">Â©Â 2017 <span class="Link-Inner">RomanÂ Komarov</span>. </a><a href="https://twitter.com/kizmarh" class="Link Link_wrapper"><span class="Link-Inner">FollowÂ me onÂ twitter</span>!</a>
          </p>
        </div>
      </div>
    </footer>
    <script>var supportsWoff2=function(A){if(!("FontFace"in A)||"function"!=typeof A.FontFace)return!1;var t=new FontFace("t",'url( "data:application/font-woff2;base64,d09GMgABAAAAAADcAAoAAAAAAggAAACWAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABk4ALAoUNAE2AiQDCAsGAAQgBSAHIBtvAcieB3aD8wURQ+TZazbRE9HvF5vde4KCYGhiCgq/NKPF0i6UIsZynbP+Xi9Ng+XLbNlmNz/xIBBqq61FIQRJhC/+QA/08PJQJ3sK5TZFMlWzC/iK5GUN40psgqvxwBjBOg6JUSJ7ewyKE2AAaXZrfUB4v+hze37ugJ9d+DeYqiDwVgCawviwVFGnuttkLqIMGivmDg" ) format( "woff2" )',{});return t.load()["catch"](function(){}),"loading"==t.status||"loaded"==t.status}(this),h=document.getElementsByTagName("head")[0],link=document.createElement("link");link.href="/s/extras"+(supportsWoff2?"2":"")+".css",link.type="text/css",link.rel="stylesheet",h.appendChild(link);
    </script>
    <script src="/j/prism.js"></script>
    <script src="//mc.yandex.ru/metrika/watch.js"></script>
    <script type="text/javascript">
      //<![CDATA[
      (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter632758 = new Ya.Metrika({id:632758, clickmap:true, trackLinks:true, trackHash:true, webvisor:true}); } catch(e) {} }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f); } else { f(); } })(document, window, "yandex_metrika_callbacks");
      //]]>
    </script>
    <noscript><img src="//mc.yandex.ru/watch/632758" style="position:absolute; left:-9990px;" alt=""></noscript>
  </body>
</html>